+                          0.35 <= TPP & TPP < 0.4 ~ "Above Average",
+                          0.4 <= TPP ~ "Elite"
+                        ))
nba_shooting <- mutate(nba_shooting,
+                        Classification = case_when(
+                          TPP < 0.2 ~  "Hopeless",
+                          0.2 <= TPP & TPP < 0.3 ~ "Below Average",
+                          0.3 <= TPP & TPP < 0.35 ~  "Average",
+                          0.35 <= TPP & TPP < 0.4 ~ "Above Average",
+                          0.4 <= TPP ~ "Elite"
+                        ))
View(nba_shooting)
nba_shooting_2016 <- filter(nba_shooting, SEASON == 2016)
summarize(nba_shooting_2016, FGP = mean(FGP))
summarize(nba_shooting_2016, FGP = mean(FGP), TPP = mean(TPP), FTP = mean(FTP))
select(nba_shooting, PLAYER, SEASON, FGP, TPP, FTP, eFGP, PTS, TPS)
save(nba_shooting, file = "data/nba_shooting.RData")
hitting_qualified <- read_csv(file= "data/hitting_qualified.csv")
View(hitting_qualified)
View(hitting_qualified)
arrange(hitting_qualified, yearID)
arrange(hitting_qualified, desc(yearID))
summarize(hitting_qualified, first = min(yearID))
summarize(hitting_qualified, first = min(yearID), last = max(yearID))
hitting_qualified <- mutate(hitting_qualified, IBB = as.integer(IBB), HBP = as.integer(HBP), SH = as.integer(SH), SF = as.integer(SF), GIDP = as.integer(GIDP))
select(hitting_qualified, playerID, yearID, AB, IBB, HBP, SH, SF, GIDP)
hitting_qualified <- replace_na(hitting_qualified, list(IBB = 0, HBP = 0, SH = 0, SF = 0, GIDP = 0))
View(hitting_qualified)
select(hitting_qualified, playerID, yearID, AB, IBB, HBP, SH, SF, GIDP)
hitting_qualified <- mutate(hitting_qualified, X1B = H - X2B - X3B - HR)
View(hitting_qualified)
hitting_qualified <- mutate(hitting_qualified, uBB = BB - IBB)
View(hitting_qualified)
hitting_qualified <- mutate(hitting_qualified, BBP = BB/PA, KP = SO/PA, OBP = (H + BB + HBP)/(AB + BB + HBP + SF), SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB, OPS = OBP + SLG, wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
View(hitting_qualified)
tmp_batting <- filter(hitting_qualified, yearID >= 2000 & yearID <= 2015)
View(tmp_batting)
batting_recent <- select(tmp_batting, playerID, yearID, teamID, lgID, BBP, KP, OBP, SLG, OPS, wOBA)
View(batting_recent)
ggplot(data = batting_recent) + geom_histogram(mapping = aes(x = SLG), bins = 50)
View(batting_recent)
View(hitting_qualified)
View(nba_shooting)
hitting_qualified <- mutate(hitting_qualified, BBP_rating = case_when( BBP < 0.055 ~  "Awful", 0.055 <= BBP & BBP < 0.07 ~ "Poor", 0.07 <= BBP & BBP < 0.08 ~ "Below Average", 0.08 <= BBP & BBP < 0.1 ~  "Average", 0.1 <= BBP & BBP < 0.125 ~ "Above Average", 0.125 <= BBP & BBP < 0.15 ~ "Great", 0.15 <= BBP ~ "Excellent"))
hitting_qualified <- mutate(hitting_qualified, KP_rating = case_when( KP > 0.25 ~  "Awful", 0.25 >= KP & KP > 0.22 ~ "Poor", 0.22 >= KP & KP > 0.2 ~ "Below Average", 0.2 >= KP & KP > 0.16 ~  "Average", 0.16 >= KP & KP > 0.125 ~ "Above Average", 0.125 >= KP & KP > 0.1 ~ "Great", 0.1 >= KP ~ "Excellent"))
hitting_qualified <- mutate(hitting_qualified, OBP_rating = case_when( OBP < 0.3 ~  "Awful", 0.3 <= OBP & OBP < 0.31 ~ "Poor", 0.31 <= OBP & OBP < 0.32 ~ "Below Average", 0.32 <= OBP & OBP < 0.34 ~  "Average", 0.34 <= OBP & OBP < 0.37 ~ "Above Average", 0.37 <= OBP & OBP < 0.39 ~ "Great", 0.39 <= OBP ~ "Excellent"))
hitting_qualified <- mutate(hitting_qualified, OPS_rating = case_when( OPS < 0.6 ~  "Awful", 0.6 <= OPS & OPS < 0.67 ~ "Poor", 0.67 <= OPS & OPS < 0.71 ~ "Below Average", 0.71 <= OPS & OPS < 0.8 ~  "Average", 0.8 <= OPS & OPS < 0.9 ~ "Above Average", 0.9 <= OPS & OPS < 1.0 ~ "Great", 1.0 <= OPS ~ "Excellent"))
hitting_qualified <- mutate(hitting_qualified, wOBA_rating = case_when( wOBA < 0.3 ~  "Awful", 0.3 <= wOBA & wOBA < 0.31 ~ "Poor", 0.31 <= wOBA & wOBA < 0.32 ~ "Below Average", 0.32 <= wOBA & wOBA < 0.34 ~  "Average", 0.34 <= wOBA & wOBA < 0.37 ~ "Above Average", 0.37 <= wOBA & wOBA < 0.4 ~ "Great", 0.4 <= wOBA ~ "Excellent"))
View(hitting_qualified)
batting_recent <- select(tmp_batting, playerID, yearID, teamID, lgID, BBP, KP, OBP, SLG, OPS, wOBA, BBP_rating, KP_rating, OBP_rating, OPS_rating, wOBA_rating)
setwd("~/Desktop/Moneyball")
library(tidyverse)
library(Lahman)
Batting <- as_tibble(Batting)
Batting %>% select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB)
Batting %>% select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB)
Batting %>% replace_na(list(HBP = 0, SF = 0)) %>%
select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB)
Batting
Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0)) %>%
select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB)
batting <-
Batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, BA, OBP, OPS, wOBA)
View(Batting)
View(Batting)
batting <-
Batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
mutate(BA = H/(AB-(BB+HBP+SH+SF))
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, BA, OBP, OPS, wOBA)
mutate(BA = H/(AB-(BB+HBP+SH+SF))
batting <-
Batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
mutate(BA = H/(AB-(BB+HBP+SH+SF))
batting <-
Batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
mutate(BA = H/(AB-(BB+HBP+SH+SF)) %>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
batting <-
Batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
mutate(BA = H/(AB-(BB+HBP+SH+SF)) %>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, BA, OB
batting <-
Batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
mutate(BA = H/(AB-(BB+HBP+SH+SF)) %>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, BA, OBP, OPS, wOBA)
batting <-
batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
mutate(BA = H/(AB-(BB+HBP+SH+SF)) %>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, BA, OBP, OPS, wOBA)
View(Batting)
View(Batting)
View(Batting)
batting <-
Batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, OBP, OPS, wOBA)
batting <-
Batting %>%
mutate(PA = AB+BB+HBP+SH+SF)%>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, OPS, wOBA)
View(Batting)
batting <- Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0)) %>%
select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB)
batting <- mutate(batting,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
batting <- mutate(batting,
PA = AB + BB + HBP + SH + SF
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
batting <- mutate(batting,
PA = AB + BB + HBP + SH + SF,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
View(batting)
View(Batting)
batting <- Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0)) %>%
batting <- Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0))
View(batting)
batting <- mutate(batting,
PA = AB + BB + HBP + SH + SF,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
View(batting)
batting <- batting %>%
select(playerID, yearID, teamID, SO, AB, BB, HBP, SH, SF, IBB)
mutate(batting,
PA = AB + BB + HBP + SH + SF,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
select(playerID, yearID, teamID, SO, AB, BB, HBP, SH, SF, IBB)
batting <- batting %>%
select(playerID, yearID, teamID, SO, AB, BB, HBP, SH, SF, IBB)
batting <- batting %>%
select(playerID, yearID, teamID, SO, AB, BB, HBP, SH, SF, IBB)
mutate(batting,
PA = AB + BB + HBP + SH + SF,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
batting <- Batting %>%
select(playerID, yearID, teamID, SO, AB, BB, HBP, SH, SF, IBB)
mutate(batting,
PA = AB + BB + HBP + SH + SF,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
Batting %>% select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB, H)
Batting %>% select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB, H)
Batting <- Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0)) %>%
Batting
Batting
View(Batting)
Batting <- Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0)) %>%
Batting <- Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0)) %>% select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB, H)
Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0)) %>% select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB, H)
Batting
View(Batting)
Batting -> replace_na(Batting, list(HBP = 0, SF = 0, SH = 0, IBB = 0))
library(tidyverse)
library(Lahman)
Batting <- as_tibble(Batting)
Batting %>% select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB)
Batting %>% replace_na(list(HBP = 0, SF = 0)) %>% select(playerID, yearID, teamID, AB, BB, HBP, SH, SF, IBB)
Batting %>% replace_na(list(HBP = 0, SF = 0)) %>% select(playerID, yearID, teamID, lgID, AB, BB, HBP, SH, SF, IBB)
Batting %>% replace_na(list(HBP = 0, SF = 0, SH = 0, IBB = 0)) %>% select(playerID, yearID, teamID, lgID, AB, BB, HBP, SH, SF, IBB)
Batting <- mutate(Batting,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
Batting <- mutate(Batting,
PA = AB + BB + HBP + SH + SF
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
Batting <- mutate(Batting,
PA = AB + BB + HBP + SH + SF,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
View(Batting)
Batting <- mutate(Batting,
X1B = H - (X2B + X3B + HR)
PA = AB + BB + HBP + SH + SF,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
Batting <- mutate(Batting,
X1B = H - (X2B + X3B + HR),
PA = AB + BB + HBP + SH + SF,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
Batting <- mutate(Batting,
uBB = BB - IBB,
X1B = H - (X2B + X3B + HR),
PA = AB + BB + HBP + SH + SF,
BBP = BB/PA,
KP = SO/PA,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
Batting <- mutate(Batting,
uBB = BB - IBB,
X1B = H - (X2B + X3B + HR),
PA = AB + BB + HBP + SH + SF,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
View(Batting)
rm(KP, BBP)
batting <-
Batting %>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, OPS, wOBA)
View(Batting)
Batting <- mutate(Batting,
uBB = BB - IBB,
BA = H / AB,
X1B = H - (X2B + X3B + HR),
PA = AB + BB + HBP + SH + SF,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
batting <-
Batting %>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, BA, PA, OPS, wOBA)
standardize <- function(x) {
mu <- mean(x, na.rm = TRUE)
sigma <- sd(x, na.rm = TRUE)
return( (x-mu)/sigma )
}
View(batting)
View(batting)
Batting <- mutate(Batting,
uBB = BB - IBB,
X1B = H - (X2B + X3B + HR),
PA = AB + BB + HBP + SH + SF,
BA = H / AB,
OBP = (H + BB + HBP)/(AB + BB + HBP + SF),
SLG = (X1B + 2*X2B + 3*X3B + 4*HR)/AB,
OPS = OBP + SLG,
wOBA = (0.687 * uBB + 0.718 * HBP + 0.81 * X1B + 1.256 * X2B + 1.594 * X3B+ 2.065 * HR)/(AB + uBB + SF + HBP))
batting <-
Batting %>%
filter(lgID %in% c("AL", "NL") & PA >= 502.2) %>%
select(playerID, yearID, teamID, lgID, PA, BA, OBP, OPS, wOBA)
batting <- batting %>%
mutate(zBA_all = standardize(BA),
zOBP_all = standardize(OBP),
zOPS_all = standardize(OPS),
zwOBA_all = standardize(wOBA))
View(batting)
batting <- batting %>%
group_by(yearID) %>%
mutate(zBA_year = standardize(BA),
zOBP_year = standardize(OBP),
zOPS_year = standardize(OPS),
zwOBA_year = standardize(wOBA))
batting <- batting %>%
ungroup() %>%
group_by(yearID, lgID) %>%
mutate(zBA_year_lg = standardize(BA),
zOBP_year_lg = standardize(OBP),
zOPS_year_lg = standardize(OPS),
zwOBA_year_lg = standardize(wOBA))
batting <- batting %>%
ungroup()
batting <- batting %>%
ungroup() %>%
group_by(yearID, lgID) %>%
mutate(zBA_year_lg = standardize(BA),
zOBP_year_lg = standardize(OBP),
zOPS_year_lg = standardize(OPS),
zwOBA_year_lg = standardize(wOBA))
batting <- batting %>%
ungroup() %>%
mutate(HIST_ERA = case_when(
1871 <= yearID & yearID <= 1892 ~ "Pioneer",
1893 <= yearID & yearID <= 1919 ~ "Spitball",
1920 <= yearID & yearID <= 1946 ~ "Landis",
1947 <= yearID & yearID <= 1968 ~ "Baby Boomer",
1969 <= yearID & yearID <= 1992 ~ "Artifical Turf",
1993 <= yearID ~ "Camden Yards")) %>%
group_by(HIST_ERA) %>%
mutate(zBA_hist = standardize(BA),
zOBP_hist = standardize(OBP),
zOPS_hist = standardize(OPS),
zwOBA_hist = standardize(wOBA))
batting <- batting %>%
ungroup() %>%
batting <- batting %>%
ungroup()
batting <- batting %>%
ungroup() %>%
read_csv(file = "data/mlb_payrolls.csv")
mlb_payrolls <- read_csv(file = "data/mlb_payrolls.csv")
View(mlb_payrolls)
mlb_payrolls <- mlb_payrolls %>%
group_by(yearID) %>%
mutate(relative_payroll = relative(Team_Payroll))
mlb_payrolls <- mlb_payrolls %>%
group_by(Team) %>%
mutate(relative_payroll = relative(Team_Payroll))
relative <- function(x) {
med <- median(x, na.rm = TRUE)
return(x/med)
}
mlb_payrolls <- read_csv(file = "data/mlb_payrolls.csv")
mlb_payrolls <- mlb_payrolls %>%
group_by(Team) %>%
mutate(relative_payroll = relative(Team_Payroll))
View(mlb_payrolls)
ggplot(data = mlb_payrolls) + geom_point(mapping = aes(x = Relative_Payroll, y = Winning_Percentage))
ggplot(data = mlb_payrolls) + geom_point(mapping = aes(x = relative_payroll, y = Winning_Percentage))
View(mlb_payrolls)
summarize(mlb_payrolls, avg_team_payroll = avg(Team_Payroll), avg_relative_payroll = avg(relative_payroll))
summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
summarize(mlb_payrolls, Average Team Payroll = mean(Team_Payroll), Average Relative Payroll = mean(relative_payroll))
summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
mutate(payroll_avg, summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
payroll
payroll_avg
payroll_avg <- tibble()
payroll_avg <-
mutate(payroll_avg, summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
payroll_avg <- payroll_avg %>%
mutate(summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
setwd("~/Desktop/Moneyball")
library(tidyverse)
pitches <- read_csv(file = "data/pitchfx_2015.csv")
View(pitches)
called_pitches <- mutate(pitches, Call = case_when( Description = "Ball" ~  0, Description = "Called Strike" ~ 1))
called_pitches <- mutate(pitches, Call = case_when( Description = Ball ~  0, Description = Called Strike ~ 1))
tmp_pitches <- filter(pitches, Description = "Ball")
tmp_pitches <- filter(pitches, Description == "Ball")
View(tmp_pitches)
tmp_pitches <- filter(pitches, Description == "Ball" | Description == "Called Strike")
View(tmp_pitches)
called_pitches <- filter(pitches, Description == "Ball" | Description == "Called Strike")
rm(tmp_pitches)
revalue(pitches$Description, c("Ball" = 0))
called_pitches <- filter(pitches, Description == "Ball" | Description == "Called Strike") %>%
mutate(Call = case_when( Description == "Ball" ~  0, Description == "Called Strike" ~ 1))
View(called_pitches)
g <- ggplot(data = called_pitches)
pitches
g <- ggplot(data = called_pitches)
g <- g + stat_summary_2d(mapping = aes(x = X, y = Y, z = Call))
g
g <- ggplot(data = called_pitches)
g <- g + stat_summary_2d(mapping = aes(x = X, y = Z, z = Call))
g
g <- g + scale_filler_distiller("P(Called Strike", palette = "RdBu")
g <- g + scale_fill_distiller("P(Called Strike", palette = "RdBu")
g
g <- g + annotate("rect", xmin = -8.5, xmax = 8.5, ymin = 19, ymax = 41.5, alpha = 9,
color = "black")
g <- g + theme_classic()
g <- g + theme(axis.title.x = element_blank())
g <- g + theme(axis.title.y = element_blank())
g <- g + labs(title = "Estimated Strike Zone")
g
g <- ggplot(data = called_pitches)
g <- g + stat_summary_2d(mapping = aes(x = X, y = Z, z = Call))
g <- g + scale_fill_distiller("P(Called Strike", palette = "RdBu")
g <- g + annotate("rect", xmin = -8.5, xmax = 8.5, ymin = 19, ymax = 41.5, alpha = 9, color = "black")
g <- g + theme_classic()
g <- g + theme(axis.title.x = element_blank())
g <- g + theme(axis.title.y = element_blank())
g <- g + labs(title = "Estimated Strike Zone")
g
g <- ggplot(data = called_pitches)
g <- g + stat_summary_2d(mapping = aes(x = X, y = Z, z = Call))
g <- g + scale_fill_distiller("P(Called Strike", palette = "RdBu")
g <- g + annotate("rect", xmin = -8.5, xmax = 8.5, ymin = 19, ymax = 41.5, alpha = 0, color = "black")
g <- g + theme_classic()
g <- g + theme(axis.title.x = element_blank())
g <- g + theme(axis.title.y = element_blank())
g <- g + labs(title = "Estimated Strike Zone")
g
g <- ggplot(data = called_pitches)
g <- g + stat_summary_2d(mapping = aes(x = X, y = Z, z = Call))
g <- g + scale_fill_distiller("P(Called Strike", palette = "RdBu")
g <- g + annotate("rect", xmin = -8.5, xmax = 8.5, ymin = 19, ymax = 41.5, alpha = 0, color = "black")
g <- g + theme_classic()
g <- g + theme(axis.title.x = element_blank())
g <- g + theme(axis.title.y = element_blank())
g <- g + labs(title = "Estimated Strike Zone")
g
raw_boxscore <- read_csv(file = "data/nba_boxscore.csv")
table(raw_boxscore[["Tm"]])
View(called_pitches)
filter(raw_boxscore, Tm == "WSB")
rm(Tm == "TOT")
payroll_avg <- payroll_avg %>%
mutate(summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
View(payroll_avg)
View(payroll_avg)
payroll_avg <- payroll_avg %>%
mutate(summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
sa
payroll_avg <- payroll_avg %>%
mutate(summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
payroll_avg <- payroll_avg %>%
mutate(summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
payroll_avg <- payroll_avg %>%
mutate(summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
a
payroll_avg <- payroll_avg %>%
mutate(summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
a
summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll), avg_relative_payroll = mean(relative_payroll))
avg_team_payroll <- summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll))
avg_team_payroll
payroll_avg <-
mutate(avg_team_payroll = avg_team_payroll)
avg_relative_payroll <- summarize(mlb_payrolls, avg_relative_payroll = mean(relative_payroll))
payroll_avg <-
mutate(avg_team_payroll = summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll)))
payroll_avg <- payroll_avg %>%
mutate(avg_team_payroll = summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll)))
rm(avg_team_payroll)
rm(avg_relative_payroll)
payroll_avg <- payroll_avg %>%
mutate(avg_team_payroll = summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll)))
payroll_avg <- payroll_avg %>%
mutate(avg_team_payroll = summarize(mlb_payrolls, mean(Team_Payroll)))
payroll_avg <- payroll_avg %>%
mutate(ATP = summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll)))
avg_team_payroll <- summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll))
View(avg_team_payroll)
summarize(mlb_payrolls, avg_relative_payroll = mean(relative_payroll)
payroll_avg <- avg_team_payroll %>%
mutate(summarize(mlb_payrolls, avg_team_payroll = mean(Team_Payroll)))
payroll_avg <- avg_team_payroll %>%
mutate(avg_relative_payroll = mean(Team_Payroll))
payroll_avg <- avg_team_payroll %>%
mutate(avg_relative_payroll = summarize(mlb_payrolls, avg_relative_payroll = mean(relative_payroll)))
payroll_avg <- avg_team_payroll %>%
mutate(avg_relative_payroll = summarize(mlb_payrolls, mean(relative_payroll)))
rm(avg_relative_payroll)
filter(raw_boxscore, Tm == "TOT")
filter(raw_boxscore, Tm !== "TOT")
filter(raw_boxscore, Tm != "TOT")
team_boxscore <- filter(raw_boxscore, Tm != "TOT")
View(team_boxscore)
team_boxscore <- team_boxscore %>%
group_by(Season, Tm)
View(team_boxscore)
setwd("~/Desktop/Moneyball")
read.csv(file = "moneyballproject/nba_draft_combine.csv")
setwd("~/Desktop/Moneyball/moneyballproject")
read.csv(file = "data/nba_draft_combine.csv")
combine_data <- read.csv(file = "data/nba_draft_combine.csv")
View(combine_data)
